{"ast":null,"code":"import { defineComponent, ref, reactive, computed, watch, nextTick, onMounted, onBeforeUnmount, toRefs, resolveComponent, resolveDirective, openBlock, createBlock, Transition, withCtx, withDirectives, createVNode, createElementVNode, normalizeClass, createElementBlock, normalizeStyle, withModifiers, resolveDynamicComponent, createCommentVNode, toDisplayString, withKeys, renderSlot, vShow, createTextVNode } from 'vue';\nimport { ElButton } from '../../button/index.mjs';\nimport '../../../directives/index.mjs';\nimport '../../../hooks/index.mjs';\nimport { ElInput } from '../../input/index.mjs';\nimport { ElOverlay } from '../../overlay/index.mjs';\nimport '../../../utils/index.mjs';\nimport '../../../constants/index.mjs';\nimport { ElIcon } from '../../icon/index.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport TrapFocus from '../../../directives/trap-focus/index.mjs';\nimport { TypeComponents, TypeComponentsMap } from '../../../utils/vue/icon.mjs';\nimport { isValidComponentSize } from '../../../utils/vue/validator.mjs';\nimport { useLocale } from '../../../hooks/use-locale/index.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { useZIndex } from '../../../hooks/use-z-index/index.mjs';\nimport { useSize } from '../../../hooks/use-common-props/index.mjs';\nimport { useDraggable } from '../../../hooks/use-draggable/index.mjs';\nimport { on, off } from '../../../utils/dom/event.mjs';\nimport { useSameTarget } from '../../../hooks/use-same-target/index.mjs';\nimport { useModal } from '../../../hooks/use-modal/index.mjs';\nimport { usePreventGlobal } from '../../../hooks/use-prevent-global/index.mjs';\nimport { EVENT_CODE } from '../../../constants/aria.mjs';\nimport { useLockscreen } from '../../../hooks/use-lockscreen/index.mjs';\nimport { useRestoreActive } from '../../../hooks/use-restore-active/index.mjs';\n\nconst _sfc_main = defineComponent({\n  name: \"ElMessageBox\",\n  directives: {\n    TrapFocus\n  },\n  components: {\n    ElButton,\n    ElInput,\n    ElOverlay,\n    ElIcon,\n    ...TypeComponents\n  },\n  inheritAttrs: false,\n  props: {\n    buttonSize: {\n      type: String,\n      validator: isValidComponentSize\n    },\n    modal: {\n      type: Boolean,\n      default: true\n    },\n    lockScroll: {\n      type: Boolean,\n      default: true\n    },\n    showClose: {\n      type: Boolean,\n      default: true\n    },\n    closeOnClickModal: {\n      type: Boolean,\n      default: true\n    },\n    closeOnPressEscape: {\n      type: Boolean,\n      default: true\n    },\n    closeOnHashChange: {\n      type: Boolean,\n      default: true\n    },\n    center: Boolean,\n    draggable: Boolean,\n    roundButton: {\n      default: false,\n      type: Boolean\n    },\n    container: {\n      type: String,\n      default: \"body\"\n    },\n    boxType: {\n      type: String,\n      default: \"\"\n    }\n  },\n  emits: [\"vanish\", \"action\"],\n\n  setup(props, {\n    emit\n  }) {\n    const {\n      t\n    } = useLocale();\n    const ns = useNamespace(\"message-box\");\n    const visible = ref(false);\n    const {\n      nextZIndex\n    } = useZIndex();\n    const state = reactive({\n      beforeClose: null,\n      callback: null,\n      cancelButtonText: \"\",\n      cancelButtonClass: \"\",\n      confirmButtonText: \"\",\n      confirmButtonClass: \"\",\n      customClass: \"\",\n      customStyle: {},\n      dangerouslyUseHTMLString: false,\n      distinguishCancelAndClose: false,\n      icon: \"\",\n      inputPattern: null,\n      inputPlaceholder: \"\",\n      inputType: \"text\",\n      inputValue: null,\n      inputValidator: null,\n      inputErrorMessage: \"\",\n      message: null,\n      modalFade: true,\n      modalClass: \"\",\n      showCancelButton: false,\n      showConfirmButton: true,\n      type: \"\",\n      title: void 0,\n      showInput: false,\n      action: \"\",\n      confirmButtonLoading: false,\n      cancelButtonLoading: false,\n      confirmButtonDisabled: false,\n      editorErrorMessage: \"\",\n      validateError: false,\n      zIndex: nextZIndex()\n    });\n    const typeClass = computed(() => {\n      const type = state.type;\n      return {\n        [ns.bm(\"icon\", type)]: type && TypeComponentsMap[type]\n      };\n    });\n    const btnSize = useSize(computed(() => props.buttonSize), {\n      prop: true,\n      form: true,\n      formItem: true\n    });\n    const iconComponent = computed(() => state.icon || TypeComponentsMap[state.type] || \"\");\n    const hasMessage = computed(() => !!state.message);\n    const rootRef = ref();\n    const headerRef = ref();\n    const inputRef = ref();\n    const confirmRef = ref();\n    const confirmButtonClasses = computed(() => state.confirmButtonClass);\n    watch(() => state.inputValue, async val => {\n      await nextTick();\n\n      if (props.boxType === \"prompt\" && val !== null) {\n        validate();\n      }\n    }, {\n      immediate: true\n    });\n    watch(() => visible.value, val => {\n      if (val) {\n        if (props.boxType === \"alert\" || props.boxType === \"confirm\") {\n          nextTick().then(() => {\n            var _a, _b, _c;\n\n            (_c = (_b = (_a = confirmRef.value) == null ? void 0 : _a.$el) == null ? void 0 : _b.focus) == null ? void 0 : _c.call(_b);\n          });\n        }\n\n        state.zIndex = nextZIndex();\n      }\n\n      if (props.boxType !== \"prompt\") return;\n\n      if (val) {\n        nextTick().then(() => {\n          if (inputRef.value && inputRef.value.$el) {\n            getInputElement().focus();\n          }\n        });\n      } else {\n        state.editorErrorMessage = \"\";\n        state.validateError = false;\n      }\n    });\n    const draggable = computed(() => props.draggable);\n    useDraggable(rootRef, headerRef, draggable);\n    onMounted(async () => {\n      await nextTick();\n\n      if (props.closeOnHashChange) {\n        on(window, \"hashchange\", doClose);\n      }\n    });\n    onBeforeUnmount(() => {\n      if (props.closeOnHashChange) {\n        off(window, \"hashchange\", doClose);\n      }\n    });\n\n    function doClose() {\n      if (!visible.value) return;\n      visible.value = false;\n      nextTick(() => {\n        if (state.action) emit(\"action\", state.action);\n      });\n    }\n\n    const handleWrapperClick = () => {\n      if (props.closeOnClickModal) {\n        handleAction(state.distinguishCancelAndClose ? \"close\" : \"cancel\");\n      }\n    };\n\n    const overlayEvent = useSameTarget(handleWrapperClick);\n\n    const handleInputEnter = e => {\n      if (state.inputType !== \"textarea\") {\n        e.preventDefault();\n        return handleAction(\"confirm\");\n      }\n    };\n\n    const handleAction = action => {\n      var _a;\n\n      if (props.boxType === \"prompt\" && action === \"confirm\" && !validate()) {\n        return;\n      }\n\n      state.action = action;\n\n      if (state.beforeClose) {\n        (_a = state.beforeClose) == null ? void 0 : _a.call(state, action, state, doClose);\n      } else {\n        doClose();\n      }\n    };\n\n    const validate = () => {\n      if (props.boxType === \"prompt\") {\n        const inputPattern = state.inputPattern;\n\n        if (inputPattern && !inputPattern.test(state.inputValue || \"\")) {\n          state.editorErrorMessage = state.inputErrorMessage || t(\"el.messagebox.error\");\n          state.validateError = true;\n          return false;\n        }\n\n        const inputValidator = state.inputValidator;\n\n        if (typeof inputValidator === \"function\") {\n          const validateResult = inputValidator(state.inputValue);\n\n          if (validateResult === false) {\n            state.editorErrorMessage = state.inputErrorMessage || t(\"el.messagebox.error\");\n            state.validateError = true;\n            return false;\n          }\n\n          if (typeof validateResult === \"string\") {\n            state.editorErrorMessage = validateResult;\n            state.validateError = true;\n            return false;\n          }\n        }\n      }\n\n      state.editorErrorMessage = \"\";\n      state.validateError = false;\n      return true;\n    };\n\n    const getInputElement = () => {\n      const inputRefs = inputRef.value.$refs;\n      return inputRefs.input || inputRefs.textarea;\n    };\n\n    const handleClose = () => {\n      handleAction(\"close\");\n    };\n\n    if (props.closeOnPressEscape) {\n      useModal({\n        handleClose\n      }, visible);\n    } else {\n      usePreventGlobal(visible, \"keydown\", e => e.code === EVENT_CODE.esc);\n    }\n\n    if (props.lockScroll) {\n      useLockscreen(visible);\n    }\n\n    useRestoreActive(visible);\n    return { ...toRefs(state),\n      ns,\n      overlayEvent,\n      visible,\n      hasMessage,\n      typeClass,\n      btnSize,\n      iconComponent,\n      confirmButtonClasses,\n      rootRef,\n      headerRef,\n      inputRef,\n      confirmRef,\n      doClose,\n      handleClose,\n      handleWrapperClick,\n      handleInputEnter,\n      handleAction,\n      t\n    };\n  }\n\n});\n\nconst _hoisted_1 = [\"aria-label\"];\nconst _hoisted_2 = {\n  key: 0\n};\nconst _hoisted_3 = [\"innerHTML\"];\n\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_icon = resolveComponent(\"el-icon\");\n\n  const _component_close = resolveComponent(\"close\");\n\n  const _component_el_input = resolveComponent(\"el-input\");\n\n  const _component_el_button = resolveComponent(\"el-button\");\n\n  const _component_el_overlay = resolveComponent(\"el-overlay\");\n\n  const _directive_trap_focus = resolveDirective(\"trap-focus\");\n\n  return openBlock(), createBlock(Transition, {\n    name: \"fade-in-linear\",\n    onAfterLeave: _cache[11] || (_cache[11] = $event => _ctx.$emit(\"vanish\"))\n  }, {\n    default: withCtx(() => [withDirectives(createVNode(_component_el_overlay, {\n      \"z-index\": _ctx.zIndex,\n      \"overlay-class\": [_ctx.ns.is(\"message-box\"), _ctx.modalClass],\n      mask: _ctx.modal\n    }, {\n      default: withCtx(() => [createElementVNode(\"div\", {\n        class: normalizeClass(`${_ctx.ns.namespace.value}-overlay-message-box`),\n        onClick: _cache[8] || (_cache[8] = (...args) => _ctx.overlayEvent.onClick && _ctx.overlayEvent.onClick(...args)),\n        onMousedown: _cache[9] || (_cache[9] = (...args) => _ctx.overlayEvent.onMousedown && _ctx.overlayEvent.onMousedown(...args)),\n        onMouseup: _cache[10] || (_cache[10] = (...args) => _ctx.overlayEvent.onMouseup && _ctx.overlayEvent.onMouseup(...args))\n      }, [withDirectives((openBlock(), createElementBlock(\"div\", {\n        ref: \"rootRef\",\n        role: \"dialog\",\n        \"aria-label\": _ctx.title || \"dialog\",\n        \"aria-modal\": \"true\",\n        class: normalizeClass([_ctx.ns.b(), _ctx.customClass, _ctx.ns.is(\"draggable\", _ctx.draggable), {\n          [_ctx.ns.m(\"center\")]: _ctx.center\n        }]),\n        style: normalizeStyle(_ctx.customStyle),\n        onClick: _cache[7] || (_cache[7] = withModifiers(() => {}, [\"stop\"]))\n      }, [_ctx.title !== null && _ctx.title !== void 0 ? (openBlock(), createElementBlock(\"div\", {\n        key: 0,\n        ref: \"headerRef\",\n        class: normalizeClass(_ctx.ns.e(\"header\"))\n      }, [createElementVNode(\"div\", {\n        class: normalizeClass(_ctx.ns.e(\"title\"))\n      }, [_ctx.iconComponent && _ctx.center ? (openBlock(), createBlock(_component_el_icon, {\n        key: 0,\n        class: normalizeClass([_ctx.ns.e(\"status\"), _ctx.typeClass])\n      }, {\n        default: withCtx(() => [(openBlock(), createBlock(resolveDynamicComponent(_ctx.iconComponent)))]),\n        _: 1\n      }, 8, [\"class\"])) : createCommentVNode(\"v-if\", true), createElementVNode(\"span\", null, toDisplayString(_ctx.title), 1)], 2), _ctx.showClose ? (openBlock(), createElementBlock(\"button\", {\n        key: 0,\n        type: \"button\",\n        class: normalizeClass(_ctx.ns.e(\"headerbtn\")),\n        \"aria-label\": \"Close\",\n        onClick: _cache[0] || (_cache[0] = $event => _ctx.handleAction(_ctx.distinguishCancelAndClose ? \"close\" : \"cancel\")),\n        onKeydown: _cache[1] || (_cache[1] = withKeys(withModifiers($event => _ctx.handleAction(_ctx.distinguishCancelAndClose ? \"close\" : \"cancel\"), [\"prevent\"]), [\"enter\"]))\n      }, [createVNode(_component_el_icon, {\n        class: normalizeClass(_ctx.ns.e(\"close\"))\n      }, {\n        default: withCtx(() => [createVNode(_component_close)]),\n        _: 1\n      }, 8, [\"class\"])], 34)) : createCommentVNode(\"v-if\", true)], 2)) : createCommentVNode(\"v-if\", true), createElementVNode(\"div\", {\n        class: normalizeClass(_ctx.ns.e(\"content\"))\n      }, [createElementVNode(\"div\", {\n        class: normalizeClass(_ctx.ns.e(\"container\"))\n      }, [_ctx.iconComponent && !_ctx.center && _ctx.hasMessage ? (openBlock(), createBlock(_component_el_icon, {\n        key: 0,\n        class: normalizeClass([_ctx.ns.e(\"status\"), _ctx.typeClass])\n      }, {\n        default: withCtx(() => [(openBlock(), createBlock(resolveDynamicComponent(_ctx.iconComponent)))]),\n        _: 1\n      }, 8, [\"class\"])) : createCommentVNode(\"v-if\", true), _ctx.hasMessage ? (openBlock(), createElementBlock(\"div\", {\n        key: 1,\n        class: normalizeClass(_ctx.ns.e(\"message\"))\n      }, [renderSlot(_ctx.$slots, \"default\", {}, () => [!_ctx.dangerouslyUseHTMLString ? (openBlock(), createElementBlock(\"p\", _hoisted_2, toDisplayString(_ctx.message), 1)) : (openBlock(), createElementBlock(\"p\", {\n        key: 1,\n        innerHTML: _ctx.message\n      }, null, 8, _hoisted_3))])], 2)) : createCommentVNode(\"v-if\", true)], 2), withDirectives(createElementVNode(\"div\", {\n        class: normalizeClass(_ctx.ns.e(\"input\"))\n      }, [createVNode(_component_el_input, {\n        ref: \"inputRef\",\n        modelValue: _ctx.inputValue,\n        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => _ctx.inputValue = $event),\n        type: _ctx.inputType,\n        placeholder: _ctx.inputPlaceholder,\n        class: normalizeClass({\n          invalid: _ctx.validateError\n        }),\n        onKeydown: withKeys(_ctx.handleInputEnter, [\"enter\"])\n      }, null, 8, [\"modelValue\", \"type\", \"placeholder\", \"class\", \"onKeydown\"]), createElementVNode(\"div\", {\n        class: normalizeClass(_ctx.ns.e(\"errormsg\")),\n        style: normalizeStyle({\n          visibility: !!_ctx.editorErrorMessage ? \"visible\" : \"hidden\"\n        })\n      }, toDisplayString(_ctx.editorErrorMessage), 7)], 2), [[vShow, _ctx.showInput]])], 2), createElementVNode(\"div\", {\n        class: normalizeClass(_ctx.ns.e(\"btns\"))\n      }, [_ctx.showCancelButton ? (openBlock(), createBlock(_component_el_button, {\n        key: 0,\n        loading: _ctx.cancelButtonLoading,\n        class: normalizeClass([_ctx.cancelButtonClass]),\n        round: _ctx.roundButton,\n        size: _ctx.btnSize,\n        onClick: _cache[3] || (_cache[3] = $event => _ctx.handleAction(\"cancel\")),\n        onKeydown: _cache[4] || (_cache[4] = withKeys(withModifiers($event => _ctx.handleAction(\"cancel\"), [\"prevent\"]), [\"enter\"]))\n      }, {\n        default: withCtx(() => [createTextVNode(toDisplayString(_ctx.cancelButtonText || _ctx.t(\"el.messagebox.cancel\")), 1)]),\n        _: 1\n      }, 8, [\"loading\", \"class\", \"round\", \"size\"])) : createCommentVNode(\"v-if\", true), withDirectives(createVNode(_component_el_button, {\n        ref: \"confirmRef\",\n        type: \"primary\",\n        loading: _ctx.confirmButtonLoading,\n        class: normalizeClass([_ctx.confirmButtonClasses]),\n        round: _ctx.roundButton,\n        disabled: _ctx.confirmButtonDisabled,\n        size: _ctx.btnSize,\n        onClick: _cache[5] || (_cache[5] = $event => _ctx.handleAction(\"confirm\")),\n        onKeydown: _cache[6] || (_cache[6] = withKeys(withModifiers($event => _ctx.handleAction(\"confirm\"), [\"prevent\"]), [\"enter\"]))\n      }, {\n        default: withCtx(() => [createTextVNode(toDisplayString(_ctx.confirmButtonText || _ctx.t(\"el.messagebox.confirm\")), 1)]),\n        _: 1\n      }, 8, [\"loading\", \"class\", \"round\", \"disabled\", \"size\"]), [[vShow, _ctx.showConfirmButton]])], 2)], 14, _hoisted_1)), [[_directive_trap_focus]])], 34)]),\n      _: 3\n    }, 8, [\"z-index\", \"overlay-class\", \"mask\"]), [[vShow, _ctx.visible]])]),\n    _: 3\n  });\n}\n\nvar MessageBoxConstructor = /* @__PURE__ */_export_sfc(_sfc_main, [[\"render\", _sfc_render], [\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/message-box/src/index.vue\"]]);\n\nexport { MessageBoxConstructor as default };","map":{"version":3,"mappings":"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","names":["_sfc_main","defineComponent","name","directives","TrapFocus","components","ElButton","ElInput","ElOverlay","ElIcon","inheritAttrs","props","buttonSize","type","validator","modal","default","lockScroll","showClose","closeOnClickModal","closeOnPressEscape","closeOnHashChange","center","draggable","roundButton","container","boxType","emits","setup","emit","t","useLocale","useNamespace","ref","nextZIndex","useZIndex","state","reactive","beforeClose","callback","cancelButtonText","cancelButtonClass","confirmButtonText","confirmButtonClass","customClass","customStyle","dangerouslyUseHTMLString","distinguishCancelAndClose","icon","inputPattern","inputPlaceholder","inputType","inputValue","inputValidator","inputErrorMessage","message","modalFade","modalClass","showCancelButton","showConfirmButton","title","showInput","action","confirmButtonLoading","cancelButtonLoading","confirmButtonDisabled","editorErrorMessage","validateError","zIndex","computed","ns","bm","TypeComponentsMap","btnSize","prop","form","formItem","hasMessage","rootRef","headerRef","inputRef","confirmRef","confirmButtonClasses","watch","val","nextTick","validate","immediate","visible","value","then","getInputElement","useDraggable","onMounted","on","onBeforeUnmount","off","doClose","handleWrapperClick","handleAction","e","validateResult","inputRefs","useModal","handleClose","usePreventGlobal","useLockscreen","useRestoreActive","overlayEvent","typeClass","iconComponent","handleInputEnter","_directive_trap_focus","_openBlock","_ctx","_createElementVNode","class","onClick","onMousedown","_withDirectives","role","b","style","key","_createBlock","_","_createCommentVNode","_toDisplayString","onKeydown","_createVNode","_createElementBlock","_renderSlot","modelValue","_cache","placeholder","invalid","loading","round","size","disabled"],"sources":["../../../../../../packages/components/message-box/src/index.vue"],"sourcesContent":["<template>\n  <transition name=\"fade-in-linear\" @after-leave=\"$emit('vanish')\">\n    <el-overlay\n      v-show=\"visible\"\n      :z-index=\"zIndex\"\n      :overlay-class=\"[ns.is('message-box'), modalClass]\"\n      :mask=\"modal\"\n    >\n      <div\n        :class=\"`${ns.namespace.value}-overlay-message-box`\"\n        @click=\"overlayEvent.onClick\"\n        @mousedown=\"overlayEvent.onMousedown\"\n        @mouseup=\"overlayEvent.onMouseup\"\n      >\n        <div\n          ref=\"rootRef\"\n          v-trap-focus\n          role=\"dialog\"\n          :aria-label=\"title || 'dialog'\"\n          aria-modal=\"true\"\n          :class=\"[\n            ns.b(),\n            customClass,\n            ns.is('draggable', draggable),\n            { [ns.m('center')]: center },\n          ]\"\n          :style=\"customStyle\"\n          @click.stop=\"\"\n        >\n          <div\n            v-if=\"title !== null && title !== undefined\"\n            ref=\"headerRef\"\n            :class=\"ns.e('header')\"\n          >\n            <div :class=\"ns.e('title')\">\n              <el-icon\n                v-if=\"iconComponent && center\"\n                :class=\"[ns.e('status'), typeClass]\"\n              >\n                <component :is=\"iconComponent\" />\n              </el-icon>\n              <span>{{ title }}</span>\n            </div>\n            <button\n              v-if=\"showClose\"\n              type=\"button\"\n              :class=\"ns.e('headerbtn')\"\n              aria-label=\"Close\"\n              @click=\"\n                handleAction(distinguishCancelAndClose ? 'close' : 'cancel')\n              \"\n              @keydown.prevent.enter=\"\n                handleAction(distinguishCancelAndClose ? 'close' : 'cancel')\n              \"\n            >\n              <el-icon :class=\"ns.e('close')\">\n                <close />\n              </el-icon>\n            </button>\n          </div>\n          <div :class=\"ns.e('content')\">\n            <div :class=\"ns.e('container')\">\n              <el-icon\n                v-if=\"iconComponent && !center && hasMessage\"\n                :class=\"[ns.e('status'), typeClass]\"\n              >\n                <component :is=\"iconComponent\" />\n              </el-icon>\n              <div v-if=\"hasMessage\" :class=\"ns.e('message')\">\n                <slot>\n                  <p v-if=\"!dangerouslyUseHTMLString\">{{ message }}</p>\n                  <p v-else v-html=\"message\" />\n                </slot>\n              </div>\n            </div>\n            <div v-show=\"showInput\" :class=\"ns.e('input')\">\n              <el-input\n                ref=\"inputRef\"\n                v-model=\"inputValue\"\n                :type=\"inputType\"\n                :placeholder=\"inputPlaceholder\"\n                :class=\"{ invalid: validateError }\"\n                @keydown.enter=\"handleInputEnter\"\n              />\n              <div\n                :class=\"ns.e('errormsg')\"\n                :style=\"{\n                  visibility: !!editorErrorMessage ? 'visible' : 'hidden',\n                }\"\n              >\n                {{ editorErrorMessage }}\n              </div>\n            </div>\n          </div>\n          <div :class=\"ns.e('btns')\">\n            <el-button\n              v-if=\"showCancelButton\"\n              :loading=\"cancelButtonLoading\"\n              :class=\"[cancelButtonClass]\"\n              :round=\"roundButton\"\n              :size=\"btnSize\"\n              @click=\"handleAction('cancel')\"\n              @keydown.prevent.enter=\"handleAction('cancel')\"\n            >\n              {{ cancelButtonText || t('el.messagebox.cancel') }}\n            </el-button>\n            <el-button\n              v-show=\"showConfirmButton\"\n              ref=\"confirmRef\"\n              type=\"primary\"\n              :loading=\"confirmButtonLoading\"\n              :class=\"[confirmButtonClasses]\"\n              :round=\"roundButton\"\n              :disabled=\"confirmButtonDisabled\"\n              :size=\"btnSize\"\n              @click=\"handleAction('confirm')\"\n              @keydown.prevent.enter=\"handleAction('confirm')\"\n            >\n              {{ confirmButtonText || t('el.messagebox.confirm') }}\n            </el-button>\n          </div>\n        </div>\n      </div>\n    </el-overlay>\n  </transition>\n</template>\n<script lang=\"ts\">\nimport {\n  computed,\n  defineComponent,\n  nextTick,\n  onBeforeUnmount,\n  onMounted,\n  reactive,\n  ref,\n  toRefs,\n  watch,\n} from 'vue'\nimport ElButton from '@element-plus/components/button'\nimport { TrapFocus } from '@element-plus/directives'\nimport {\n  useDraggable,\n  useLocale,\n  useLockscreen,\n  useModal,\n  useNamespace,\n  usePreventGlobal,\n  useRestoreActive,\n  useSameTarget,\n  useSize,\n  useZIndex,\n} from '@element-plus/hooks'\nimport ElInput from '@element-plus/components/input'\nimport { ElOverlay } from '@element-plus/components/overlay'\nimport {\n  TypeComponents,\n  TypeComponentsMap,\n  isValidComponentSize,\n  off,\n  on,\n} from '@element-plus/utils'\nimport { EVENT_CODE } from '@element-plus/constants'\nimport { ElIcon } from '@element-plus/components/icon'\n\nimport type { PropType } from 'vue'\nimport type { ComponentSize } from '@element-plus/constants'\nimport type {\n  Action,\n  MessageBoxState,\n  MessageBoxType,\n} from './message-box.type'\n\nexport default defineComponent({\n  name: 'ElMessageBox',\n  directives: {\n    TrapFocus,\n  },\n  components: {\n    ElButton,\n    ElInput,\n    ElOverlay,\n    ElIcon,\n    ...TypeComponents,\n  },\n  inheritAttrs: false,\n  props: {\n    buttonSize: {\n      type: String as PropType<ComponentSize>,\n      validator: isValidComponentSize,\n    },\n    modal: {\n      type: Boolean,\n      default: true,\n    },\n    lockScroll: {\n      type: Boolean,\n      default: true,\n    },\n    showClose: {\n      type: Boolean,\n      default: true,\n    },\n    closeOnClickModal: {\n      type: Boolean,\n      default: true,\n    },\n    closeOnPressEscape: {\n      type: Boolean,\n      default: true,\n    },\n    closeOnHashChange: {\n      type: Boolean,\n      default: true,\n    },\n    center: Boolean,\n    draggable: Boolean,\n    roundButton: {\n      default: false,\n      type: Boolean,\n    },\n    container: {\n      type: String, // default append to body\n      default: 'body',\n    },\n    boxType: {\n      type: String as PropType<MessageBoxType>,\n      default: '',\n    },\n  },\n  emits: ['vanish', 'action'],\n  setup(props, { emit }) {\n    // const popup = usePopup(props, doClose)\n    const { t } = useLocale()\n    const ns = useNamespace('message-box')\n    const visible = ref(false)\n    const { nextZIndex } = useZIndex()\n    // s represents state\n    const state = reactive<MessageBoxState>({\n      beforeClose: null,\n      callback: null,\n      cancelButtonText: '',\n      cancelButtonClass: '',\n      confirmButtonText: '',\n      confirmButtonClass: '',\n      customClass: '',\n      customStyle: {},\n      dangerouslyUseHTMLString: false,\n      distinguishCancelAndClose: false,\n      icon: '',\n      inputPattern: null,\n      inputPlaceholder: '',\n      inputType: 'text',\n      inputValue: null,\n      inputValidator: null,\n      inputErrorMessage: '',\n      message: null,\n      modalFade: true,\n      modalClass: '',\n      showCancelButton: false,\n      showConfirmButton: true,\n      type: '',\n      title: undefined,\n      showInput: false,\n      action: '' as Action,\n      confirmButtonLoading: false,\n      cancelButtonLoading: false,\n      confirmButtonDisabled: false,\n      editorErrorMessage: '',\n      // refer to: https://github.com/ElemeFE/element/commit/2999279ae34ef10c373ca795c87b020ed6753eed\n      // seemed ok for now without this state.\n      // isOnComposition: false, // temporary remove\n      validateError: false,\n      zIndex: nextZIndex(),\n    })\n\n    const typeClass = computed(() => {\n      const type = state.type\n      return { [ns.bm('icon', type)]: type && TypeComponentsMap[type] }\n    })\n\n    const btnSize = useSize(\n      computed(() => props.buttonSize),\n      { prop: true, form: true, formItem: true }\n    )\n\n    const iconComponent = computed(\n      () => state.icon || TypeComponentsMap[state.type] || ''\n    )\n    const hasMessage = computed(() => !!state.message)\n    const rootRef = ref<HTMLElement>()\n    const headerRef = ref<HTMLElement>()\n    const inputRef = ref<HTMLElement>()\n    const confirmRef = ref<HTMLElement>()\n\n    const confirmButtonClasses = computed(() => state.confirmButtonClass)\n\n    watch(\n      () => state.inputValue,\n      async (val) => {\n        await nextTick()\n        if (props.boxType === 'prompt' && val !== null) {\n          validate()\n        }\n      },\n      { immediate: true }\n    )\n\n    watch(\n      () => visible.value,\n      (val) => {\n        if (val) {\n          if (props.boxType === 'alert' || props.boxType === 'confirm') {\n            nextTick().then(() => {\n              confirmRef.value?.$el?.focus?.()\n            })\n          }\n          state.zIndex = nextZIndex()\n        }\n        if (props.boxType !== 'prompt') return\n        if (val) {\n          nextTick().then(() => {\n            if (inputRef.value && inputRef.value.$el) {\n              getInputElement().focus()\n            }\n          })\n        } else {\n          state.editorErrorMessage = ''\n          state.validateError = false\n        }\n      }\n    )\n\n    const draggable = computed(() => props.draggable)\n    useDraggable(rootRef, headerRef, draggable)\n\n    onMounted(async () => {\n      await nextTick()\n      if (props.closeOnHashChange) {\n        on(window, 'hashchange', doClose)\n      }\n    })\n\n    onBeforeUnmount(() => {\n      if (props.closeOnHashChange) {\n        off(window, 'hashchange', doClose)\n      }\n    })\n\n    function doClose() {\n      if (!visible.value) return\n      visible.value = false\n      nextTick(() => {\n        if (state.action) emit('action', state.action)\n      })\n    }\n\n    const handleWrapperClick = () => {\n      if (props.closeOnClickModal) {\n        handleAction(state.distinguishCancelAndClose ? 'close' : 'cancel')\n      }\n    }\n\n    const overlayEvent = useSameTarget(handleWrapperClick)\n\n    const handleInputEnter = (e: KeyboardEvent) => {\n      if (state.inputType !== 'textarea') {\n        e.preventDefault()\n        return handleAction('confirm')\n      }\n    }\n\n    const handleAction = (action: Action) => {\n      if (props.boxType === 'prompt' && action === 'confirm' && !validate()) {\n        return\n      }\n\n      state.action = action\n\n      if (state.beforeClose) {\n        state.beforeClose?.(action, state, doClose)\n      } else {\n        doClose()\n      }\n    }\n\n    const validate = () => {\n      if (props.boxType === 'prompt') {\n        const inputPattern = state.inputPattern\n        if (inputPattern && !inputPattern.test(state.inputValue || '')) {\n          state.editorErrorMessage =\n            state.inputErrorMessage || t('el.messagebox.error')\n          state.validateError = true\n          return false\n        }\n        const inputValidator = state.inputValidator\n        if (typeof inputValidator === 'function') {\n          const validateResult = inputValidator(state.inputValue)\n          if (validateResult === false) {\n            state.editorErrorMessage =\n              state.inputErrorMessage || t('el.messagebox.error')\n            state.validateError = true\n            return false\n          }\n          if (typeof validateResult === 'string') {\n            state.editorErrorMessage = validateResult\n            state.validateError = true\n            return false\n          }\n        }\n      }\n      state.editorErrorMessage = ''\n      state.validateError = false\n      return true\n    }\n\n    const getInputElement = () => {\n      const inputRefs = inputRef.value.$refs\n      return (inputRefs.input || inputRefs.textarea) as HTMLElement\n    }\n\n    const handleClose = () => {\n      handleAction('close')\n    }\n\n    // when close on press escape is disabled, pressing esc should not callout\n    // any other message box and close any other dialog-ish elements\n    // e.g. Dialog has a close on press esc feature, and when it closes, it calls\n    // props.beforeClose method to make a intermediate state by callout a message box\n    // for some verification or alerting. then if we allow global event liek this\n    // to dispatch, it could callout another message box.\n    if (props.closeOnPressEscape) {\n      useModal(\n        {\n          handleClose,\n        },\n        visible\n      )\n    } else {\n      usePreventGlobal(\n        visible,\n        'keydown',\n        (e: KeyboardEvent) => e.code === EVENT_CODE.esc\n      )\n    }\n\n    // locks the screen to prevent scroll\n    if (props.lockScroll) {\n      useLockscreen(visible)\n    }\n\n    // restore to prev active element.\n    useRestoreActive(visible)\n\n    return {\n      ...toRefs(state),\n      ns,\n      overlayEvent,\n      visible,\n      hasMessage,\n      typeClass,\n      btnSize,\n      iconComponent,\n      confirmButtonClasses,\n      rootRef,\n      headerRef,\n      inputRef,\n      confirmRef,\n      doClose, // for outside usage\n      handleClose, // for out side usage\n      handleWrapperClick,\n      handleInputEnter,\n      handleAction,\n      t,\n    }\n  },\n})\n</script>\n"]},"metadata":{},"sourceType":"module"}